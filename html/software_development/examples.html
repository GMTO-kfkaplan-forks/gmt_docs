

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>6. Running Examples &mdash; GMT Software And Controls documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/additional_style.css" type="text/css" />
  

  

  
    <link rel="top" title="GMT Software And Controls documentation" href="../index.html"/>
        <link rel="up" title="Software Development" href="index.html"/>
        <link rel="next" title="7. Contribute" href="contribute.html"/>
        <link rel="prev" title="5. Using the Services" href="services.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> GMT Software And Controls
          

          
            
            <img src="../_static/logowhite.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../release_notes/index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../system_level_PDR/index.html">Architecture and Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../SWCS_Standards/index.html">Software and Controls Standards</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Software Development</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="installation.html">1. Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="isample_example.html">2. ISample Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html">3. Developer Info and Release Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="DCS_development/index.html">4. DCS Development</a></li>
<li class="toctree-l2"><a class="reference internal" href="services.html">5. Using the Services</a></li>
<<<<<<< HEAD
<li class="toctree-l2 current"><a class="current reference internal" href="#">6. Running Examples</a><ul>
=======
<li class="toctree-l2 current"><a class="current reference internal" href="">6. Running Examples</a><ul>
>>>>>>> aa305e246c52769c7a310942a2a167e38cc9c992
<li class="toctree-l3"><a class="reference internal" href="#gmt-components">6.1. GMT Components</a></li>
<li class="toctree-l3"><a class="reference internal" href="#connecting-components">6.2. Connecting Components</a></li>
<li class="toctree-l3"><a class="reference internal" href="#running-the-example-components">6.3. Running the example components</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setup-components-and-ports">6.4. Setup Components and Ports</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hardware-adapters-ethercat-example">6.5. Hardware Adapters: Ethercat Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#controllers-example">6.6. Controllers Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#check-monitored-values">6.7. Check Monitored Values</a></li>
<li class="toctree-l3"><a class="reference internal" href="#send-a-command-to-a-controller">6.8. Send a Command to a Controller</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hdk-controller-with-ethercat-adapter">6.9. HDK Controller With Ethercat Adapter</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="contribute.html">7. Contribute</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">GMT Software And Controls</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">Software Development</a> &raquo;</li>
      
    <li>6. Running Examples</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="running-examples">
<h1>6. Running Examples<a class="headerlink" href="#running-examples" title="Permalink to this headline">¶</a></h1>
<div class="section" id="gmt-components">
<h2>6.1. GMT Components<a class="headerlink" href="#gmt-components" title="Permalink to this headline">¶</a></h2>
<p>Components are the simple building blocks in the GMT software architecture and they will be used extensively at all levels.
A software component is a unit of composition with contractually specified interfaces and explicit context dependencies only.
Ports are interaction points for components. They can be the data inputs (required interface) or the data outputs (provided interface) of our components.
By using a port, our component is able to de-couple the internals of the component from external entities. The component does not assume anything about external entities.
Any data type can be used in ports: C++ templates, dynamic types, etc.</p>
<p>A GMT Component is able to perform a periodic task and/or is able to interact with other similar components. Components are reactive to their interfaces from the very beginning.
Instead of being called by an external entity they have an internal loop (step) which reacts continuously to inputs and drives the corresponding outputs.
Commands in the sense of “remote calls” from other components do not exist. Only reaction to inputs.</p>
<p>Example: instead of having a moveTo(position) and getPosition() commands we can have:</p>
<blockquote>
<div><ul class="simple">
<li>An input port with the demanded_position</li>
<li>An output with the current_position</li>
<li>The step() reacts to the demanded position and updates the current</li>
</ul>
</div></blockquote>
<p>The most simple possible component that can be created is like this:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="k">struct</span> <span class="nl">SimpleComponent</span> <span class="p">:</span> <span class="k">public</span> <span class="n">Component</span><span class="o">&lt;</span><span class="n">Component_Conf</span><span class="o">&gt;</span>  <span class="c1">// most simple possible component</span>
<span class="p">{</span>
    <span class="n">SimpleComponent</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">uri</span><span class="p">)</span><span class="o">:</span> <span class="n">Component</span><span class="p">(</span><span class="n">uri</span><span class="p">)</span> <span class="p">{}</span>
    <span class="kr">inline</span> <span class="kt">void</span> <span class="n">step</span><span class="p">()</span>  <span class="p">{</span> <span class="n">log_info</span><span class="p">(</span><span class="s">&quot;hello, component world&quot;</span><span class="p">);</span> <span class="p">}</span> <span class="c1">// prints a log message every second (default)</span>
<span class="p">};</span>
</pre></div>
</div>
<p>This component does not have any input or output ports but has a <em>step()</em> function that runs at the default rate of 1 second.
This step only creates a log message at every step but could be used for any other purpose.</p>
<p>Let&#8217;s see an example with input and output ports. The following diagram show a component called Sum with two inputs ports and one output port.
The output port is the sum of the inputs ports:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>      Sum
   +--------+
   <span class="p">|</span>        <span class="p">|</span>
&lt;--<span class="p">|</span>x1    x2<span class="p">|</span>&lt;--        <span class="nv">x1</span> <span class="o">=</span> x2+x3
   <span class="p">|</span>        <span class="p">|</span>
   <span class="p">|</span>      x3<span class="p">|</span>&lt;--
   <span class="p">|</span>        <span class="p">|</span>
   +--------+
</pre></div>
</div>
<p>The class definition for this component is:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Sum</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Component</span><span class="o">&lt;</span><span class="n">Component_Conf</span><span class="o">&gt;</span>
<span class="p">{</span>
    <span class="k">public</span><span class="o">:</span>
        <span class="kr">inline</span> <span class="n">Sum</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">uri</span><span class="p">)</span><span class="o">:</span> <span class="n">Component</span><span class="p">(</span><span class="n">uri</span><span class="p">),</span> <span class="n">x1</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">x2</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">x3</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">{}</span>

        <span class="kr">inline</span> <span class="kt">void</span> <span class="n">setup</span><span class="p">()</span> <span class="p">{</span>
            <span class="n">new_output_port</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="s">&quot;x1&quot;</span><span class="p">);</span>
            <span class="n">new_input_port</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span><span class="s">&quot;x2&quot;</span><span class="p">);</span>
            <span class="n">new_input_port</span><span class="p">(</span><span class="n">x3</span><span class="p">,</span><span class="s">&quot;x3&quot;</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="kr">inline</span> <span class="kt">void</span> <span class="n">step</span><span class="p">()</span> <span class="p">{</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">x3</span><span class="p">;</span>
            <span class="n">log_info</span><span class="p">(</span><span class="s">&quot;sum = &quot;</span> <span class="o">+</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">x1</span><span class="p">));</span>
        <span class="p">}</span>

    <span class="k">private</span><span class="o">:</span>
        <span class="kt">int</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
<p>This example only includes integer ports but any type can be used.  The input and output ports default value can be set during a the constructor.
The step() computes the sum and the setup() function is responsible for associating the internal component variables with the corresponding ports.
Once this association is made the ports automatically update (send or receive) the inputs and output values at each step.
The component does not need to do update the ports because, for any component, the framework performs the following generic step:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="n">Component</span><span class="o">::</span><span class="n">generic_step</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">read_setup</span><span class="p">();</span>
    <span class="n">read_inputs</span><span class="p">();</span>
    <span class="n">step</span><span class="p">();</span>
    <span class="n">write_outputs</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="connecting-components">
<h2>6.2. Connecting Components<a class="headerlink" href="#connecting-components" title="Permalink to this headline">¶</a></h2>
<p>The great thing about components is that they can be easily connected with other components to perform a much more complex function.
A connector is a link that enables communication between components. A connector simply means that runtime component instances can communicate using their ports.</p>
<p>Let&#8217;s create a component type called Inc with just one output port. This component has an initial value that is incremented at every step.
If the internal counter is reset every 1000 steps.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>       Inc
   ----------
   <span class="p">|</span>        <span class="p">|</span>
&lt;--<span class="p">|</span>x1      <span class="p">|</span>      <span class="nv">x1</span> <span class="o">=</span> x1+1
   <span class="p">|</span>        <span class="p">|</span>
   <span class="p">|</span>        <span class="p">|</span>
   <span class="p">|</span>        <span class="p">|</span>
   ----------
</pre></div>
</div>
<p>This is the equivalent c++ class:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Inc</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Component</span><span class="o">&lt;</span><span class="n">Component_Conf</span><span class="o">&gt;</span>
<span class="p">{</span>
    <span class="k">public</span><span class="o">:</span>
        <span class="kr">inline</span> <span class="n">Inc</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">uri</span><span class="p">)</span><span class="o">:</span> <span class="n">Component</span><span class="p">(</span><span class="n">uri</span><span class="p">),</span> <span class="n">x1</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">{}</span>

        <span class="kr">inline</span> <span class="kt">void</span> <span class="n">setup</span><span class="p">()</span> <span class="p">{</span>
            <span class="n">new_output_port</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="s">&quot;x1&quot;</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="kr">inline</span> <span class="kt">void</span> <span class="n">step</span><span class="p">()</span> <span class="p">{</span>
            <span class="n">x1</span><span class="o">++</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">x1</span><span class="o">&gt;</span><span class="mi">1000</span><span class="p">)</span> <span class="n">x1</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
            <span class="n">log_info</span><span class="p">(</span><span class="s">&quot;x1 = &quot;</span> <span class="o">+</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">x1</span><span class="p">));</span>
        <span class="p">}</span>

    <span class="k">private</span><span class="o">:</span>
        <span class="kt">int</span> <span class="n">x1</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Now we can create several instances of the Inc and Sum component classes and, connecting inputs and outputs, we could create a component network like this:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>                    sum1                inc1
   sum2            +---+               +---+
   +---+           <span class="p">|</span>   <span class="p">|</span>&lt;--------------<span class="p">|</span>   <span class="p">|</span>
   <span class="p">|</span>   <span class="p">|</span>&lt;----------<span class="p">|</span> + <span class="p">|</span>               +---+
&lt;--<span class="p">|</span> + <span class="p">|</span>           <span class="p">|</span>   <span class="p">|</span>&lt;-------+
   <span class="p">|</span>   <span class="p">|</span>&lt;-----+    +---+        <span class="p">|</span>       inc2
   +---+      <span class="p">|</span>                 <span class="p">|</span>      +---+
              <span class="p">|</span>                 +------<span class="p">|</span>   <span class="p">|</span>
              <span class="p">|</span>                        +---+
              <span class="p">|</span>
              <span class="p">|</span>                         inc3
              <span class="p">|</span>                        +---+
              +------------------------<span class="p">|</span>   <span class="p">|</span>
                                       +---+
</pre></div>
</div>
<p>Note that this diagram includes five <strong>connectors</strong> between components. These connectors allow to move data between components.
At each step, if the connector is setup, the output of each component instance is sent to the next component in the connector.
It&#8217;s important to know that <strong>each component does not know if connectors exist</strong>: they do not have references to other components.
Each component reads its inputs and proceeds according these values to run the step and write the corresponding outputs.
Components will run even when their ports are not connected to other components.</p>
<p>The code of this example can be seen at:</p>
<blockquote>
<div><em>src/runtime/src/obs_fwk/core_fwk/c++/examples/example_components</em></div></blockquote>
</div>
<div class="section" id="running-the-example-components">
<h2>6.3. Running the example components<a class="headerlink" href="#running-the-example-components" title="Permalink to this headline">¶</a></h2>
<p>In one terminal open a log_client so</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ log_client
log client subscribed at port tcp://127.0.0.1:9995
</pre></div>
</div>
<p>In a second terminal run the example components</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ run_example_components
</pre></div>
</div>
<p>After this command the example components will start to send log messages to the log service so we should see something like:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="o">[</span>gmto@gpodevsrv02 core<span class="o">]</span>$ log_client
log client subscribed at port tcp://127.0.0.1:9995
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T16:24:38.730Z <span class="o">[</span>gmt://examples/my_app:7000<span class="o">]</span> starting
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T16:24:38.731Z <span class="o">[</span>gmt://examples/my_app:7000<span class="o">]</span> init
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T16:24:38.731Z <span class="o">[</span>gmt://examples/simple_component:8000<span class="o">]</span> starting
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T16:24:38.731Z <span class="o">[</span>gmt://examples/component_inc1:8001<span class="o">]</span> starting
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T16:24:38.731Z <span class="o">[</span>gmt://examples/component_inc2:8002<span class="o">]</span> starting
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T16:24:38.731Z <span class="o">[</span>gmt://examples/component_inc3:8003<span class="o">]</span> starting
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T16:24:38.731Z <span class="o">[</span>gmt://examples/component_sum1:8004<span class="o">]</span> starting
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T16:24:38.731Z <span class="o">[</span>gmt://examples/component_sum2:8005<span class="o">]</span> starting
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T16:24:38.732Z <span class="o">[</span>gmt://examples/component_inc2:8002<span class="o">]</span> <span class="nv">x1</span> <span class="o">=</span> 1
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T16:24:38.732Z <span class="o">[</span>gmt://examples/simple_component:8000<span class="o">]</span> hello, component world
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T16:24:38.732Z <span class="o">[</span>gmt://examples/component_inc3:8003<span class="o">]</span> <span class="nv">x1</span> <span class="o">=</span> 1
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T16:24:38.732Z <span class="o">[</span>gmt://examples/component_inc1:8001<span class="o">]</span> <span class="nv">x1</span> <span class="o">=</span> 1
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T16:24:38.732Z <span class="o">[</span>gmt://examples/my_app:7000<span class="o">]</span> app step <span class="nv">num</span> <span class="o">=</span> 0
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T16:24:38.732Z <span class="o">[</span>gmt://examples/component_sum1:8004<span class="o">]</span> <span class="nv">sum</span> <span class="o">=</span> 3
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T16:24:38.732Z <span class="o">[</span>gmt://examples/component_sum2:8005<span class="o">]</span> <span class="nv">sum</span> <span class="o">=</span> 3
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T16:24:39.732Z <span class="o">[</span>gmt://examples/component_inc2:8002<span class="o">]</span> <span class="nv">x1</span> <span class="o">=</span> 2
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T16:24:39.732Z <span class="o">[</span>gmt://examples/simple_component:8000<span class="o">]</span> hello, component world
</pre></div>
</div>
<p>At the startup the components are not setup and ports can&#8217;t be connected so each component is running alone.
For example, let&#8217;s see what the component sum2 is doing:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ log_client sum2
log client subscribed at port tcp://127.0.0.1:9995
subscription topic: sum2
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T16:34:57.300Z <span class="o">[</span>gmt://examples/component_sum2:8005<span class="o">]</span> starting
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T16:34:57.301Z <span class="o">[</span>gmt://examples/component_sum2:8005<span class="o">]</span> <span class="nv">sum</span> <span class="o">=</span> 3
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T16:34:58.301Z <span class="o">[</span>gmt://examples/component_sum2:8005<span class="o">]</span> <span class="nv">sum</span> <span class="o">=</span> 3
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T16:34:59.301Z <span class="o">[</span>gmt://examples/component_sum2:8005<span class="o">]</span> <span class="nv">sum</span> <span class="o">=</span> 3
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T16:35:00.301Z <span class="o">[</span>gmt://examples/component_sum2:8005<span class="o">]</span> <span class="nv">sum</span> <span class="o">=</span> 3
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T16:35:01.301Z <span class="o">[</span>gmt://examples/component_sum2:8005<span class="o">]</span> <span class="nv">sum</span> <span class="o">=</span> 3
</pre></div>
</div>
<p>In this case the component sum2 is still not receiving values from other components so it&#8217;s only processing the default inputs.
As the ports x2 and x3 are always:</p>
<dl class="docutils">
<dt>::</dt>
<dd>sum2.x2 = 1   (see default constructor for Sum class components)
sum2.x3 = 2</dd>
</dl>
<p>then</p>
<dl class="docutils">
<dt>::</dt>
<dd>sum2.x1 = 3</dd>
</dl>
<p>In order to receive data from other components all components ports shall be setup.</p>
</div>
<div class="section" id="setup-components-and-ports">
<h2>6.4. Setup Components and Ports<a class="headerlink" href="#setup-components-and-ports" title="Permalink to this headline">¶</a></h2>
<p>When a components starts it will automatically run its step() loop at the required rate.
On each step() it checks its inputs, process the inputs and sets the outputs. At the init phase only the setup port is ready.
It can receive the following component setup:</p>
<blockquote>
<div><ul class="simple">
<li>tcpip_port num</li>
<li>Rate (can be dinamically changed)</li>
<li>Inputs: list of ports</li>
<li>Outputs: list of ports</li>
<li>Per each port: name, protocol (push/pull …), url, mode, step_rate</li>
</ul>
</div></blockquote>
<p>Any component can receive its setup using:</p>
<blockquote>
<div><em>Usage:</em>  <tt class="docutils literal"><span class="pre">setup_component</span>&nbsp; <span class="pre">subsystem_name</span>&nbsp; <span class="pre">component_name</span></tt></div></blockquote>
<p>This command will look the component configuration at:</p>
<blockquote>
<div><cite>${GMT_ROOT}/var/lib/gmt/cson/runtime/db/config/&lt;subsystem_name&gt;/&lt;component_name&gt;.cson</cite></div></blockquote>
<p>For example, <em>component_sum1</em> has the following configuration in:</p>
<blockquote>
<div><cite>${GMT_ROOT}/var/lib/gmt/cson/runtime/db/config/examples/component_sum1.cson</cite></div></blockquote>
<div class="highlight-python"><div class="highlight"><pre><span></span>component_setup:
    name        : &#39;examples/component_sum1&#39;
    port        : 8004
    host        : &#39;127.0.0.1&#39;
    rate        : &#39;1000000&#39;
    input_ports : [ [ &quot;x2&quot;, &quot;pull&quot;, &quot;tcp://127.0.0.1:9001&quot;, &quot;async&quot;, 1]
                    [ &quot;x3&quot;, &quot;pull&quot;, &quot;tcp://127.0.0.1:9002&quot;, &quot;async&quot;, 1] ]
    output_ports : [ [ &quot;x1&quot;, &quot;push&quot;, &quot;tcp://127.0.0.1:9004&quot;, &quot;async&quot;, 1] ]
</pre></div>
</div>
<p>To connect all the example components as described in the previous section the following commands can be used:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ setup_component examples component_inc1
setup file: /home/user/work/gmt_model/install/var/lib/gmt/cson/runtime/db/config/examples/component_inc1.cson
setup url: tcp://127.0.0.1:8001
$ setup_component examples component_inc2
setup file: /home/user/work/gmt_model/install/var/lib/gmt/cson/runtime/db/config/examples/component_inc2.cson
setup url: tcp://127.0.0.1:8002
$ setup_component examples component_inc3
setup file: /home/user/work/gmt_model/install/var/lib/gmt/cson/runtime/db/config/examples/component_inc3.cson
setup url: tcp://127.0.0.1:8003
$ setup_component examples component_sum1
install/var/lib/gmt/cson/runtime/db/config/examples/component_sum1.cson
setup url: tcp://127.0.0.1:8004
$ setup_component examples component_sum2
setup file: /home/user/work/gmt_model/install/var/lib/gmt/cson/runtime/db/config/examples/component_sum2.cson
setup url: tcp://127.0.0.1:8005
</pre></div>
</div>
<p>and in terminal two we can see that the the component A2 is num processing the other component inputs.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ log_client sum2
log client subscribed at port tcp://127.0.0.1:9995
subscription topic: sum2
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T17:21:57.385Z <span class="o">[</span>gmt://examples/component_sum2:8005<span class="o">]</span> <span class="nv">sum</span> <span class="o">=</span> 3
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T17:21:58.385Z <span class="o">[</span>gmt://examples/component_sum2:8005<span class="o">]</span> <span class="nv">sum</span> <span class="o">=</span> 3
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T17:21:59.385Z <span class="o">[</span>gmt://examples/component_sum2:8005<span class="o">]</span> <span class="nv">sum</span> <span class="o">=</span> 3
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T17:22:00.386Z <span class="o">[</span>gmt://examples/component_sum2:8005<span class="o">]</span> new setup received
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T17:22:00.386Z <span class="o">[</span>gmt://examples/component_sum2:8005<span class="o">]</span> new port <span class="o">[</span>x1 -&gt; tcp://127.0.0.1:9005/push~async@1<span class="o">]</span>
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T17:22:00.386Z <span class="o">[</span>gmt://examples/component_sum2:8005<span class="o">]</span> new port <span class="o">[</span>x2 -&gt; tcp://127.0.0.1:9004/pull~async@1<span class="o">]</span>
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T17:22:00.386Z <span class="o">[</span>gmt://examples/component_sum2:8005<span class="o">]</span> new port <span class="o">[</span>x3 -&gt; tcp://127.0.0.1:9003/pull~async@1<span class="o">]</span>
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T17:22:00.386Z <span class="o">[</span>gmt://examples/component_sum2:8005<span class="o">]</span> <span class="nv">sum</span> <span class="o">=</span> 3
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T17:22:01.386Z <span class="o">[</span>gmt://examples/component_sum2:8005<span class="o">]</span> <span class="nv">sum</span> <span class="o">=</span> 22
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T17:22:02.386Z <span class="o">[</span>gmt://examples/component_sum2:8005<span class="o">]</span> <span class="nv">sum</span> <span class="o">=</span> 63
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T17:22:03.386Z <span class="o">[</span>gmt://examples/component_sum2:8005<span class="o">]</span> <span class="nv">sum</span> <span class="o">=</span> 63
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T17:22:04.386Z <span class="o">[</span>gmt://examples/component_sum2:8005<span class="o">]</span> <span class="nv">sum</span> <span class="o">=</span> 63
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T17:22:05.386Z <span class="o">[</span>gmt://examples/component_sum2:8005<span class="o">]</span> <span class="nv">sum</span> <span class="o">=</span> 63
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T17:22:06.386Z <span class="o">[</span>gmt://examples/component_sum2:8005<span class="o">]</span> <span class="nv">sum</span> <span class="o">=</span> 63
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T17:22:07.386Z <span class="o">[</span>gmt://examples/component_sum2:8005<span class="o">]</span> <span class="nv">sum</span> <span class="o">=</span> 63
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T17:22:08.386Z <span class="o">[</span>gmt://examples/component_sum2:8005<span class="o">]</span> <span class="nv">sum</span> <span class="o">=</span> 63
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T17:22:09.386Z <span class="o">[</span>gmt://examples/component_sum2:8005<span class="o">]</span> <span class="nv">sum</span> <span class="o">=</span> 63
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T17:22:10.386Z <span class="o">[</span>gmt://examples/component_sum2:8005<span class="o">]</span> <span class="nv">sum</span> <span class="o">=</span> 63
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T17:22:11.386Z <span class="o">[</span>gmt://examples/component_sum2:8005<span class="o">]</span> <span class="nv">sum</span> <span class="o">=</span> 73
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T17:22:12.386Z <span class="o">[</span>gmt://examples/component_sum2:8005<span class="o">]</span> <span class="nv">sum</span> <span class="o">=</span> 93
<span class="o">[</span>INF<span class="o">]</span> 2016-09-06T17:22:13.386Z <span class="o">[</span>gmt://examples/component_sum2:8005<span class="o">]</span> <span class="nv">sum</span> <span class="o">=</span> 93
</pre></div>
</div>
<p>All components, except the application, run at the 1s rate. The application has a 3s step rate.
The application will run for 1000 steps and then will automatically finish (see application source code).</p>
</div>
<div class="section" id="hardware-adapters-ethercat-example">
<h2>6.5. Hardware Adapters: Ethercat Example<a class="headerlink" href="#hardware-adapters-ethercat-example" title="Permalink to this headline">¶</a></h2>
<p>The GMT control system has to interface with many kinds of sensors and actuators which are connected to the optomechanical devices.
EtherCAT will be used as the interface with most systems but other kind of interfaces and protocols such as serial port, usb or cameralink will be required.
The I/O Framework (io_fwk) provides the infrastructure to interface with this hardware in a standard way for GMT purposes.
The interface between the control system and the hardware of the system under control is done by means of Hardware Adapters (HwAdapter class).
Hardware Adapters encapsulate the system device drivers, in most cases provided by external libraries, required to access the hardware and they adapt the driver interface to the GMT standard interface.</p>
<p>Device drivers are in general externally developed and have a custom interface. Some work is required to integrate them with the rest of the control system software.
Using HwAdapters as regular GMT Components simplifies operations and interfaces at low level and allows a better integration with the rest of the control system for things like:</p>
<blockquote>
<div><ul class="simple">
<li>Telemetry: monitor some device driver input/output</li>
<li>Create user interface panels</li>
<li>Sequencing for engineering or testing</li>
<li>Integrate simulators with the same interface than the real system</li>
<li>Anything that is developed for the general components can be used with no change with the HwAdapters</li>
</ul>
</div></blockquote>
<p>The EtherCAT Hardware Adapter (EthercatAdapter class) is responsible to integrate EtherCAT fieldbuses with other components.
When one subsystem needs to use EtherCAT it can inherit from the EthercatAdapter class in order to connect with the hardware that needs in a convenient way.
Let&#8217;s see an example using this adapter.</p>
<p>This example provides an specific hardware adapter (that inherits from EtherCAT) and using in/out ports it connects to the external actuators and sensors.
This specific example can be connected to the GMT Hardware Development Kit (HDK).</p>
<p>Please, see this example source code at:</p>
<blockquote>
<div><cite>${GMT_ROOT}/src/runtime/src/obs_fwk/io_fwk/c++/examples/ethercat_example</cite></div></blockquote>
<p>In order to run this example keep the log_client open in a different terminal. Then we can start the example as:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ run_ethercat_example <span class="p">&amp;</span>
</pre></div>
</div>
<p>In the log_client terminal the following message should shown:</p>
<blockquote>
<div>[INF] 2016-09-07 16:56:47.220166219 UTC [gmt://examples/ethercat_example:8001] starting</div></blockquote>
<p>At this point the adapter is waiting to receive the port setup so we can do:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ setup_component examples ethercat_example
</pre></div>
</div>
<p>And the following messages shall be shown:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:56:52.196852312 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> new setup received
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:56:52.196938558 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> new port <span class="o">[</span>ecat_config -&gt; tcp://172.16.10.13:9001/pull~async@1<span class="o">]</span>
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:56:52.196983446 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> new port <span class="o">[</span>dig_out -&gt; tcp://172.16.10.13:9002/pull~async@1<span class="o">]</span>
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:56:52.197019790 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> new port <span class="o">[</span>motor_ctrl -&gt; tcp://172.16.10.13:9003/pull~async@1<span class="o">]</span>
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:56:52.197073296 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> new port <span class="o">[</span>dig_in -&gt; tcp://172.16.10.13:9100/push~async@1<span class="o">]</span>
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:56:52.197136764 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> new port <span class="o">[</span>temperatures -&gt; tcp://172.16.10.13:9101/push~async@1<span class="o">]</span>
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:56:52.197192761 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> new port <span class="o">[</span>motor_state -&gt; tcp://172.16.10.13:9102/push~async@1<span class="o">]</span>
</pre></div>
</div>
<p>Apart of the standard component setup, the EthercatAdapter needs the Ethercat bus configuration which includes:</p>
<blockquote>
<div><ul class="simple">
<li>Masters: id and rate</li>
<li>Slaves: name, type, position, master</li>
<li>Domains: id, master, rate</li>
<li>PDO and SDO: name, std_name, slave, domain, index, subindex, bit</li>
</ul>
</div></blockquote>
<p>We can send the ethercat configuration through the <em>ecat_config</em> port using the following command:</p>
<blockquote>
<div><em>Usage:</em>  <tt class="docutils literal"><span class="pre">ethercat_config</span>&nbsp; <span class="pre">subsystem_name</span>&nbsp; <span class="pre">ethercat_adapter</span>&nbsp; <span class="pre">configuration</span></tt></div></blockquote>
<p>This port is already defined in the base class. Specific adapters only define the required ports.</p>
<p>For example, the following command:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ ethercat_config examples ethercat_example ethercat_config
</pre></div>
</div>
<p>will send the bus configuration defined in:</p>
<blockquote>
<div><cite>${GMT_ROOT}/var/lib/gmt/cson/runtime/db/config/examples/ethercat_config.cson</cite> bus config</div></blockquote>
<p>to the <em>ecat_config</em> port of the adapter.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last">
<li><p class="first">Default EtherCAT objects defined at:</p>
<blockquote>
<div><p><cite>${GMT_ROOT}/var/lib/gmt/cson/runtime/db/config/ethercat/ethercat_example.cson</cite></p>
</div></blockquote>
</li>
</ul>
</div>
<p>When the configuration is receive the adapter will start to connecting to slaves and loading the required PDOS/SDOs:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.910184951 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> ethercat config received: <span class="m">7</span> slaves <span class="m">6</span> inputs <span class="m">11</span> outputs
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.910198652 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> loading master: <span class="m">0</span> with <span class="m">1000</span> µs step rate <span class="o">(</span>1000.000000 Hz<span class="o">)</span>
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.910206325 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> loading domain: <span class="m">0</span> with <span class="m">10000</span> µs step rate <span class="o">(</span>100.000000 Hz<span class="o">)</span>
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.910209518 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> loading domain: <span class="m">1</span> with <span class="m">1000000</span> µs step rate <span class="o">(</span>1.000000 Hz<span class="o">)</span>
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.910212901 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> loading slave: coupler <span class="o">(</span>EK1100-11<span class="o">)</span>
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.910216096 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> loading slave: dig_inp <span class="o">(</span>EL1809-10<span class="o">)</span>
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.910218277 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> loading slave: dig_out <span class="o">(</span>EL2809-10<span class="o">)</span>
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.910221097 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> loading slave: ana_inp <span class="o">(</span>EL3002-14<span class="o">)</span>
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.910222788 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> loading slave: pt100 <span class="o">(</span>EL3202-14<span class="o">)</span>
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.910225430 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> loading slave: ana_out <span class="o">(</span>EL4032-13<span class="o">)</span>
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.910227145 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> loading slave: motor <span class="o">(</span>EL7041-17<span class="o">)</span>
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.910237600 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> loading data <span class="nv">object</span> <span class="o">=</span>&gt; EL1809-10:RED Push Button <span class="o">(</span><span class="m">24576</span> <span class="m">1</span> 0<span class="o">)</span>
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.910245250 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> loading data <span class="nv">object</span> <span class="o">=</span>&gt; EL1809-10:GREEN Push Button <span class="o">(</span><span class="m">24592</span> <span class="m">1</span> 0<span class="o">)</span>
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.910250492 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> loading data <span class="nv">object</span> <span class="o">=</span>&gt; EL1809-10:Emergency Button <span class="o">(</span><span class="m">24608</span> <span class="m">1</span> 0<span class="o">)</span>
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.910262722 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> loading data <span class="nv">object</span> <span class="o">=</span>&gt; EL3202-14:Temperature <span class="c1">#1 (24576 17 0)</span>
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.910272763 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> loading data <span class="nv">object</span> <span class="o">=</span>&gt; EL3202-14:Temperature <span class="c1">#2 (24592 17 0)</span>
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.910286502 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> loading data <span class="nv">object</span> <span class="o">=</span>&gt; EL7041-17:Axis Ready <span class="o">(</span><span class="m">24592</span> <span class="m">1</span> 0<span class="o">)</span>
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.910299426 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> loading data <span class="nv">object</span> <span class="o">=</span>&gt; EL7041-17:Axis Enabled <span class="o">(</span><span class="m">24592</span> <span class="m">2</span> 0<span class="o">)</span>
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.910311614 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> loading data <span class="nv">object</span> <span class="o">=</span>&gt; EL7041-17:Axis Warning <span class="o">(</span><span class="m">24592</span> <span class="m">3</span> 0<span class="o">)</span>
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.910323962 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> loading data <span class="nv">object</span> <span class="o">=</span>&gt; EL7041-17:Axis Error <span class="o">(</span><span class="m">24592</span> <span class="m">4</span> 0<span class="o">)</span>
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.910337250 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> loading data <span class="nv">object</span> <span class="o">=</span>&gt; EL7041-17:Axis Moving + <span class="o">(</span><span class="m">24592</span> <span class="m">5</span> 0<span class="o">)</span>
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.910349939 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> loading data <span class="nv">object</span> <span class="o">=</span>&gt; EL7041-17:Axis Moving - <span class="o">(</span><span class="m">24592</span> <span class="m">6</span> 0<span class="o">)</span>
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.910357182 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> loading data <span class="nv">object</span> <span class="o">=</span>&gt; EL2809-10:Pilot Light <span class="o">(</span><span class="m">28672</span> <span class="m">1</span> 0<span class="o">)</span>
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.910362927 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> loading data <span class="nv">object</span> <span class="o">=</span>&gt; EL2809-10:Emergency Light <span class="o">(</span><span class="m">28688</span> <span class="m">1</span> 0<span class="o">)</span>
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.910369179 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> loading data <span class="nv">object</span> <span class="o">=</span>&gt; EL2809-10:Heartbeat <span class="o">(</span><span class="m">28736</span> <span class="m">1</span> 0<span class="o">)</span>
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.910382354 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> loading data <span class="nv">object</span> <span class="o">=</span>&gt; EL7041-17:Axis Enable <span class="o">(</span><span class="m">28688</span> <span class="m">1</span> 0<span class="o">)</span>
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.910395462 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> loading data <span class="nv">object</span> <span class="o">=</span>&gt; EL7041-17:Axis Reset <span class="o">(</span><span class="m">28688</span> <span class="m">2</span> 0<span class="o">)</span>
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.910412059 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> loading data <span class="nv">object</span> <span class="o">=</span>&gt; EL7041-17:Velocity <span class="o">(</span><span class="m">28688</span> <span class="m">33</span> 0<span class="o">)</span>
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.910421164 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> loading data <span class="nv">object</span> <span class="o">=</span>&gt; EL3202-14:Sensor <span class="nb">type</span> <span class="c1">#1 (32768 26 0)</span>
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.910429687 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> loading data <span class="nv">object</span> <span class="o">=</span>&gt; EL3202-14:Sensor <span class="nb">type</span> <span class="c1">#2 (32784 26 0)</span>
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.910430900 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> starting ethercat master
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.910490351 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> <span class="o">[</span>0<span class="o">]</span> 0x02 0x044C2C52 0x00110000 EK1100 EtherCAT-Koppler <span class="o">(</span>2A E-Bus<span class="o">)</span>
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.910497596 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> <span class="o">[</span>1<span class="o">]</span> 0x02 0x03F03052 0x00110000 EL1008 8K. Dig. Eingang 24V, 3ms
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.910503865 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> <span class="o">[</span>2<span class="o">]</span> 0x02 0x07D83052 0x00110000 EL2008 8K. Dig. Ausgang 24V, 0.5A
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.910526114 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> <span class="o">[</span>3<span class="o">]</span> 0x02 0x0BBA3052 0x00140000 EL3002 2K.Ana. Eingang  +/-10V
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.910534140 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> <span class="o">[</span>4<span class="o">]</span> 0x02 0x0C823052 0x00130000 EL3202 2K.Ana. Eingang PT100 <span class="o">(</span>RTD<span class="o">)</span>
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.910541438 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> <span class="o">[</span>5<span class="o">]</span> 0x02 0x0FC03052 0x00110000 EL4032 2K. Ana. Ausgang +/-10V, 12bit
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.910550378 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> <span class="o">[</span>6<span class="o">]</span> 0x02 0x1B813052 0x00170000 EL7041 1K. Schrittmotor-Endstufe <span class="o">(</span>50V, 5A<span class="o">)</span>
Sensor <span class="nb">type</span> <span class="c1">#1 = 1</span>
Sensor <span class="nb">type</span> <span class="c1">#2 = 3</span>
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.937446234 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> ethercat master started
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.937483034 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> slaves detected: 7
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.937484279 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> AL states: PREOP
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.937484902 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> Link is UP
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.937487120 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EK1100-11 state PREOP
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.937487809 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EK1100-11 is ONLINE
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.937488936 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL1809-10 state PREOP
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.937489548 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL1809-10 is ONLINE
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.937490546 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL2809-10 state PREOP
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.937491195 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL2809-10 is ONLINE
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.937492115 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL3002-14 state PREOP
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.937492746 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL3002-14 is ONLINE
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.937493666 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL3202-14 state PREOP
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.937494263 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL3202-14 is ONLINE
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.937495591 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL4032-13 state PREOP
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.937496300 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL4032-13 is ONLINE
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.937497248 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL7041-17 state PREOP
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.937497882 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL7041-17 is ONLINE
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.976536682 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EK1100-11 state INIT
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.987029821 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EK1100-11 state PREOP
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.993356922 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EK1100-11 state SAFEOP
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.997538470 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EK1100-11 state OP
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:01.997540427 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EK1100-11 is OPERATIONAL
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:02.003864692 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL1809-10 state INIT
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:02.014412242 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL1809-10 state PREOP
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:02.022810420 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL1809-10 state SAFEOP
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:02.027030270 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL1809-10 state OP
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:02.027032124 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL1809-10 is OPERATIONAL
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:02.031257847 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> domain wc 1
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:02.031259776 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> domain wc state INCOMPLETE
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:02.033360873 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL2809-10 state INIT
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:02.043864805 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL2809-10 state PREOP
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:02.052304692 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL2809-10 state SAFEOP
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:02.056534717 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL2809-10 state OP
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:02.056536564 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL2809-10 is OPERATIONAL
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:02.062811721 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL3002-14 state INIT
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:02.062817303 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> domain wc 3
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:02.075468024 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL3002-14 state PREOP
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:02.115467588 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL3002-14 state SAFEOP
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:02.119646879 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL3002-14 state OP
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:02.119648863 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL3002-14 is OPERATIONAL
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:02.125977275 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL3202-14 state INIT
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:02.138593852 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL3202-14 state PREOP
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:02.147033499 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL3202-14 state SAFEOP
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:02.151252770 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL3202-14 state OP
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:02.151254884 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL3202-14 is OPERATIONAL
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:02.157582289 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL4032-13 state INIT
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:02.157587009 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> domain wc 4
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:02.170240134 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL4032-13 state PREOP
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:02.178647074 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL4032-13 state SAFEOP
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:02.182865269 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL4032-13 state OP
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:02.182867251 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL4032-13 is OPERATIONAL
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:02.189194108 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL7041-17 state INIT
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:02.201811217 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL7041-17 state PREOP
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:02.271303805 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL7041-17 state SAFEOP
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:02.283923018 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> domain wc 7
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:02.283925065 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> domain wc state COMPLETE
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:02.582866053 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL7041-17 state OP
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:02.582868440 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> EL7041-17 is OPERATIONAL
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:02.584972497 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> AL states: OP
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:04.042207131 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> domain wc 1
<span class="o">[</span>INF<span class="o">]</span> 2016-09-07 16:57:04.042209707 UTC <span class="o">[</span>gmt://examples/ethercat_example:8001<span class="o">]</span> domain wc state COMPLETE
</pre></div>
</div>
<p>At this point we can use the defined input and output ports to connect from and to the hardware.
We&#8217;ll see later how to use these ports in real applications but let&#8217;s see how easy is to use them quickly.
Create a simple coffeescript file like the following and call it hdk_lights_control.coffee.</p>
<div class="highlight-coffeescript"><div class="highlight"><pre><span></span><span class="nv">nanomsg = </span><span class="nx">require</span><span class="p">(</span><span class="s">&quot;nanomsg&quot;</span><span class="p">)</span>
<span class="nv">msgpack = </span><span class="nx">require</span><span class="p">(</span><span class="s">&quot;msgpack-lite&quot;</span><span class="p">)</span>
<span class="nv">socket  = </span><span class="nx">nanomsg</span><span class="p">.</span><span class="nx">socket</span><span class="p">(</span><span class="s">&quot;push&quot;</span><span class="p">)</span>
<span class="nv">port_address = </span><span class="s">&quot;tcp://127.0.0.1:9002&quot;</span>
<span class="nv">pilot_light     = </span><span class="kc">true</span>
<span class="nv">emergency_light = </span><span class="kc">true</span>
<span class="nv">heartbeat_led   = </span><span class="kc">true</span>
<span class="nv">lights = </span><span class="p">[</span>  <span class="nx">pilot_light</span><span class="p">,</span> <span class="nx">emergency_light</span><span class="p">,</span> <span class="nx">heartbeat_led</span> <span class="p">]</span>
<span class="nx">socket</span><span class="p">.</span><span class="nx">connect</span> <span class="nx">port_address</span>
<span class="nx">socket</span><span class="p">.</span><span class="nx">send</span> <span class="nx">msgpack</span><span class="p">.</span><span class="nx">encode</span><span class="p">(</span><span class="nx">lights</span><span class="p">)</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&quot;lights switched ON&quot;</span>
</pre></div>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ coffee hdk_lights_control.coffee
</pre></div>
</div>
<p>Running this command will switch on the pilot, the emergency light and a led in the digital out module used as heartbeat.
Other ports could be used in the same way for simple purposes but note that <strong>this script does not use any other component</strong>.
As we&#8217;ll see in next section using the GMT Controllers and the rest of frameworks will make this process simpler and more useful.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In order to finish the example the run_ethercat_example process must be killed.</p>
</div>
</div>
<div class="section" id="controllers-example">
<h2>6.6. Controllers Example<a class="headerlink" href="#controllers-example" title="Permalink to this headline">¶</a></h2>
<p>Controllers are the components responsible to control the different telescope or instruments devices.
Usually controllers are connected to the external sensors and actuators using the Hardware Adapters that we have seen before.
Many different kinds of controllers will be created for the telescope depending on the type of equipment to be controlled.
In order to know or maintain the state of the system under control the controllers will use State Variables.</p>
<p>A simple controller with a temperature state variable (simulated, with no real hardware) is provided at:</p>
<blockquote>
<div><cite>${GMT_ROOT}/src/runtime/src/obs_fwk/ctrl_fwk/c++/examples/simple_controller</cite></div></blockquote>
<p>Note that the controller implementation c++ code is split in three different files: general, setup and step.
This is for code generation purposes and because it&#8217;s easy to focus development only on the step() loop.</p>
<p>The configuration for this controller is:</p>
<blockquote>
<div><cite>${GMT_ROOT}/var/lib/gmt/cson/runtime/db/config/examples/simple_controller.cson</cite></div></blockquote>
<div class="highlight-bash"><div class="highlight"><pre><span></span>component_setup:
    name         : <span class="s1">&#39;examples/simple_controller&#39;</span>
    port         : 8001
    host         : <span class="s1">&#39;127.0.0.1&#39;</span>
    rate         : <span class="s1">&#39;1000000&#39;</span>
    input_ports  : <span class="o">[</span> <span class="o">[</span> <span class="s1">&#39;temperature_setpoint&#39;</span>, <span class="s1">&#39;pull&#39;</span>, <span class="s1">&#39;tcp://127.0.0.1:9001&#39;</span>, <span class="s1">&#39;async&#39;</span>, 1<span class="o">]</span> <span class="o">]</span>
    output_ports : <span class="o">[</span> <span class="o">[</span> <span class="s1">&#39;temperature_monitor&#39;</span>,  <span class="s1">&#39;push&#39;</span>, <span class="s1">&#39;tcp://127.0.0.1:9011&#39;</span>, <span class="s1">&#39;async&#39;</span>, 1000<span class="o">]</span> <span class="o">]</span>
state_vars:
    temperature: <span class="o">{</span> type: <span class="s1">&#39;float&#39;</span>, init: 23.4, min: 2.0, max: 26.1, url: <span class="s1">&#39;tcp://127.0.0.1:9011&#39;</span> <span class="o">}</span>
</pre></div>
</div>
<p>In order to run this controller open a log_client in different terminal and in other terminal use:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ run_simple_controller <span class="p">&amp;</span>
</pre></div>
</div>
<p>then send the setup using:</p>
<blockquote>
<div>$ setup_component examples simple_controller</div></blockquote>
</div>
<div class="section" id="check-monitored-values">
<h2>6.7. Check Monitored Values<a class="headerlink" href="#check-monitored-values" title="Permalink to this headline">¶</a></h2>
<p>Telemetry is a distributed service than can be started independently on each component as:</p>
<blockquote>
<div><em>Usage:</em>  <tt class="docutils literal"><span class="pre">monitor_component</span>&nbsp; <span class="pre">subsystem_name</span>&nbsp; <span class="pre">component_name</span></tt></div></blockquote>
<p>This command will start the telemetry adapters for this component and they will send monitored values to the server.
The telemetry service will:</p>
<blockquote>
<div><ul class="simple">
<li>store data points in the database</li>
<li>send the values to subscribers</li>
<li>accept queries from clients</li>
</ul>
</div></blockquote>
<p>Note that monitors are the values of the state variables defined in the controller (state_var section).</p>
<p>For example, the following command will start sending &#8216;temperature&#8217; data points to the telemetry service.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ monitor_component examples simple_controller
</pre></div>
</div>
<p>To check the monitored values a telemetry_client can be started in another unix terminal:</p>
<blockquote>
<div><em>Usage:</em>  <tt class="docutils literal"><span class="pre">telemetry_client</span> <span class="pre">[topic]</span></tt></div></blockquote>
<p>In the case will have:</p>
<blockquote>
<div>$ telemetry_client</div></blockquote>
<p>And the monitored values shall be received on this terminal.</p>
<p>A query can also be sent to the telemetry service like this:</p>
<blockquote>
<div><em>Usage:</em>  <tt class="docutils literal"><span class="pre">telemetry_query</span>&nbsp; <span class="pre">monitor_name</span>&nbsp; <span class="pre">num</span></tt></div></blockquote>
<p>For example, the following will list the last 12 temperature values (from newest to oldest) from this controller:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ telemetry_query examples.simple_controller.temperature 12
</pre></div>
</div>
<p>All telemetry queries have to be done on specific monitors.</p>
</div>
<div class="section" id="send-a-command-to-a-controller">
<h2>6.8. Send a Command to a Controller<a class="headerlink" href="#send-a-command-to-a-controller" title="Permalink to this headline">¶</a></h2>
<p>Some numeric values can be sent directly to ports of any controller like this:</p>
<blockquote>
<div><em>Usage:</em>  <tt class="docutils literal"><span class="pre">send_value</span> <span class="pre">subsystem</span>&nbsp; <span class="pre">controller</span>&nbsp; <span class="pre">port_name</span> <span class="pre">value</span> <span class="pre">{</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">float</span> <span class="pre">}</span></tt></div></blockquote>
<p>For example:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ send_value examples simple_controller temperature_setpoint 23.3 float
</pre></div>
</div>
<p>This will send a temperature setpoint of 23.3 to the controller which should react to this change.
State var values shall change on the telemetry client.
When the temperature values are out the the defined range the log client should show the corresponding warning messages.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In order to finish the example the run_simple_controller process shall be killed.</p>
</div>
</div>
<div class="section" id="hdk-controller-with-ethercat-adapter">
<h2>6.9. HDK Controller With Ethercat Adapter<a class="headerlink" href="#hdk-controller-with-ethercat-adapter" title="Permalink to this headline">¶</a></h2>
<p>The HDK example contains and example with an EthercatAdapter and a simple Controller for the HDK.</p>
<blockquote>
<div><cite>${GMT_ROOT}/src/runtime/src/obs_fwk/ctrl_fwk/c++/examples/hdk_controller</cite></div></blockquote>
<p>Use the following commands to start and setup these components:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ run_hdk_controller <span class="p">&amp;</span>
$ setup_component hdk_cs hw_adapter
$ ethercat_config hdk_cs hw_adapter
$ setup_component hdk_cs controller
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="contribute.html" class="btn btn-neutral float-right" title="7. Contribute" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="services.html" class="btn btn-neutral" title="5. Using the Services" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, contributors.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0-rc1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>