

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>4.1. Introduction &mdash; GMT Software And Controls documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/additional_style.css" type="text/css" />
  

  

  
    <link rel="top" title="GMT Software And Controls documentation" href="../../../index.html"/>
        <link rel="up" title="4. DCS Development" href="../index.html"/>
        <link rel="next" title="4.2. DCS specification example: isample_dcs" href="../specification/specification.html"/>
        <link rel="prev" title="4. DCS Development" href="../index.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> GMT Software And Controls
          

          
            
            <img src="../../../_static/logowhite.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../release_notes/index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../system_level_PDR/index.html">Architecture and Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../SWCS_Standards/index.html">Software and Controls Standards</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Software Development</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../installation.html">1. Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../isample_example.html">2. ISample Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../configuration.html">3. Developer Info and Release Configuration</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">4. DCS Development</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="">4.1. Introduction</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#edit-the-system-master-file">4.1.1. Edit the System Master File</a></li>
<li class="toctree-l4"><a class="reference internal" href="#define-the-components-in-the-model">4.1.2. Define the Components in the Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#compile-the-model">4.1.3. Compile the Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#load-the-model">4.1.4. Load the Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#generate-c-code">4.1.5. Generate C++ Code</a></li>
<li class="toctree-l4"><a class="reference internal" href="#make-and-run-the-generated-component">4.1.6. Make and Run the Generated Component</a></li>
<li class="toctree-l4"><a class="reference internal" href="#modify-the-generated-controller">4.1.7. Modify the Generated Controller</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../specification/specification.html">4.2. DCS specification example: <em>isample_dcs</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="../codegen/codegen.html">4.3. DCS code generation example: <em>isample_dcs</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="../model_elements/elements.html">4.4. Model Elements</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../services.html">5. Using the Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples.html">6. Running Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contribute.html">7. Contribute</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../index.html">GMT Software And Controls</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../../index.html">Software Development</a> &raquo;</li>
      
          <li><a href="../index.html">4. DCS Development</a> &raquo;</li>
      
    <li>4.1. Introduction</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="introduction">
<span id="mdf-introduction"></span><h1>4.1. Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<p>ISample is an example of a Device Control System specification. It provides
a template that can be used by DCS developers to quick start their own
specification. Initialy ISample is focused in the specification of the
control packages. The specification of other packages (e.g.calibration
or diagnostics) follows the same principles. It will include</p>
<div class="section" id="edit-the-system-master-file">
<h2>4.1.1. Edit the System Master File<a class="headerlink" href="#edit-the-system-master-file" title="Permalink to this headline">¶</a></h2>
<p>In order to add a Device Control System (DCS) first it&#8217;s necessary to add it to the master file:</p>
<blockquote>
<div>src/model/db/swc_sys.coffee</div></blockquote>
<p>In the example provided we create hdk_cs (hardware developer kit control system) with the control package (hdk_ctrl_pkg) and two components inside: one controller and one adapter.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>hdk_cs:
    wbs: &quot;1.3.3.2&quot;
    pbs: &quot;3.1.2&quot;
    elements:
        hdk_ctrl_pkg:
            elements:
                hdk_controller: { instances: 1, c_factor: 1, r_factor: 1, procurement: &quot;swc&quot;, phase: &quot;design&quot;, resource: &quot;labor&quot;, assignee: &quot;person1&quot;, fte_perc: &quot;100&quot;, status: &quot;NON_STARTED&quot;,   activity_type: &quot;activity&quot;, release: [1], stage: &quot;1&quot; }
                hdk_hw_adapter:  { instances: 1, c_factor: 1, r_factor: 1, procurement: &quot;swc&quot;, phase: &quot;design&quot;, resource: &quot;labor&quot;, assignee: &quot;person1&quot;, fte_perc: &quot;100&quot;, status: &quot;NON_STARTED&quot;, activity_type: &quot;activity&quot;, release: [1], stage: &quot;1&quot; }
</pre></div>
</div>
</div>
<div class="section" id="define-the-components-in-the-model">
<h2>4.1.2. Define the Components in the Model<a class="headerlink" href="#define-the-components-in-the-model" title="Permalink to this headline">¶</a></h2>
<p>In this case we&#8217;ll create the HDK_CS as an Instrument DCS:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">src</span><span class="o">/</span><span class="n">model</span><span class="o">/</span><span class="n">db</span><span class="o">/</span><span class="n">idcs</span><span class="o">/</span><span class="n">hdk_cs</span><span class="o">/</span><span class="n">hdk_cs</span><span class="o">.</span><span class="n">coffee</span>
<span class="n">src</span><span class="o">/</span><span class="n">model</span><span class="o">/</span><span class="n">db</span><span class="o">/</span><span class="n">idcs</span><span class="o">/</span><span class="n">hdk_cs</span><span class="o">/</span><span class="n">hdk_cs</span><span class="o">.</span><span class="n">rst</span>
<span class="n">src</span><span class="o">/</span><span class="n">model</span><span class="o">/</span><span class="n">db</span><span class="o">/</span><span class="n">idcs</span><span class="o">/</span><span class="n">hdk_cs</span><span class="o">/</span><span class="n">loader</span><span class="o">.</span><span class="n">coffee</span>
</pre></div>
</div>
<p>NOTE: The src/model/db/idcs/loader.coffee shall include the hdk_cs/loader file.</p>
</div>
<div class="section" id="compile-the-model">
<h2>4.1.3. Compile the Model<a class="headerlink" href="#compile-the-model" title="Permalink to this headline">¶</a></h2>
<p>From the ${GMT_ROOT} folder run</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ make
</pre></div>
</div>
<p>This will compile the model files an check for some errors.</p>
</div>
<div class="section" id="load-the-model">
<h2>4.1.4. Load the Model<a class="headerlink" href="#load-the-model" title="Permalink to this headline">¶</a></h2>
<p>Run the following command to start the command line</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="si">${</span><span class="nv">GMT_ROOT</span><span class="si">}</span>/bin/gmt
</pre></div>
</div>
<p>The model is loaded into memory and the gmt model prompt is shown</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>gmt<span class="o">(</span>1.0<span class="o">)</span>: Loading models...
gmt&gt;
</pre></div>
</div>
</div>
<div class="section" id="generate-c-code">
<h2>4.1.5. Generate C++ Code<a class="headerlink" href="#generate-c-code" title="Permalink to this headline">¶</a></h2>
<p>We can generate the C++ skeletons from the model as follows:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>gmt&gt; gmt.model.&lt;subsystem&gt;.gen_code<span class="o">()</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>gmt&gt; gmt.model.&lt;package&gt;.gen_code<span class="o">()</span>
</pre></div>
</div>
<p>For example, as we only have one package defined in the hdk_cs we can use:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>gmt&gt; gmt.model.hdk_ctrL_pkg.gen_code<span class="o">()</span>
</pre></div>
</div>
<p>These files are generated into src/runtime/src/idcs/hdk_cs/hdk_ctrl_pkg as defined in the model files.
If a file already exist a warning is shown. In this case the existing file shall be renamed or removed.
After the files are generated we still need to do a couple of things manually:</p>
<p>The same controller can have many instances with different names and configurations.
Copy the configuration file as instance configuration file into the config directory and use the same instance name than in the model files.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ cp hdk_controller_config.cson <span class="si">${</span><span class="nv">GMT_ROOT</span><span class="si">}</span>/src/runtime/db/config/hdk_cs/controller.cson
$ cp hdk_hw_adapter_config.cson <span class="si">${</span><span class="nv">GMT_ROOT</span><span class="si">}</span>/src/runtime/db/config/hdk_cs/hw_adapter.cson
</pre></div>
</div>
<p>Note: configuration files shall be manually edited.</p>
</div>
<div class="section" id="make-and-run-the-generated-component">
<h2>4.1.6. Make and Run the Generated Component<a class="headerlink" href="#make-and-run-the-generated-component" title="Permalink to this headline">¶</a></h2>
<p>The binaries are in the build/ folder using make</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ make
</pre></div>
</div>
<p>and can be executed from there or installed in the bin directory.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ ./build/run_hdk_controller
</pre></div>
</div>
<p>This shall start the controller, sending some logs and wait for the setup.</p>
<p>In C++ if the GMT_DEBUG is defined at compile time log messages and compiler debug info is included.
If not defined DEBUG messages and debug info is not included in the executables.</p>
</div>
<div class="section" id="modify-the-generated-controller">
<h2>4.1.7. Modify the Generated Controller<a class="headerlink" href="#modify-the-generated-controller" title="Permalink to this headline">¶</a></h2>
<p>Follow the provided examples to modify and run your own controllers.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../specification/specification.html" class="btn btn-neutral float-right" title="4.2. DCS specification example: isample_dcs" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../index.html" class="btn btn-neutral" title="4. DCS Development" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, contributors.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'1.0-rc1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>